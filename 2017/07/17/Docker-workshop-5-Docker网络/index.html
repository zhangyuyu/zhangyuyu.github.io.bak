<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Docker," />





  <link rel="alternate" href="/atom.xml" title="若见喻笺" type="application/atom+xml" />






<meta name="description" content="一、前言　　上一篇 Docker的数据存储主要讲述Docker数据管理的两种方式：数据卷和数据卷容器。本篇主要讲述网络的实现、网络模型、网络模式等相关知识。 二、背景　　该系列《Docker in Prodcution》内容包含如下部分：  容器简介 Docker简介 Docker的基本操作 Docker数据存储 Docker网络 Docker安全 多主机部署 服务发现 日志、跟踪、监控  三、网">
<meta name="keywords" content="Docker">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker Workshop（五）Docker网络">
<meta property="og:url" content="http://yoursite.com/2017/07/17/Docker-workshop-5-Docker网络/index.html">
<meta property="og:site_name" content="若见喻笺">
<meta property="og:description" content="一、前言　　上一篇 Docker的数据存储主要讲述Docker数据管理的两种方式：数据卷和数据卷容器。本篇主要讲述网络的实现、网络模型、网络模式等相关知识。 二、背景　　该系列《Docker in Prodcution》内容包含如下部分：  容器简介 Docker简介 Docker的基本操作 Docker数据存储 Docker网络 Docker安全 多主机部署 服务发现 日志、跟踪、监控  三、网">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/imgs/docker-network-implement.png">
<meta property="og:image" content="http://yoursite.com/imgs/docker-network-concept.png">
<meta property="og:updated_time" content="2018-05-27T09:18:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Docker Workshop（五）Docker网络">
<meta name="twitter:description" content="一、前言　　上一篇 Docker的数据存储主要讲述Docker数据管理的两种方式：数据卷和数据卷容器。本篇主要讲述网络的实现、网络模型、网络模式等相关知识。 二、背景　　该系列《Docker in Prodcution》内容包含如下部分：  容器简介 Docker简介 Docker的基本操作 Docker数据存储 Docker网络 Docker安全 多主机部署 服务发现 日志、跟踪、监控  三、网">
<meta name="twitter:image" content="http://yoursite.com/imgs/docker-network-implement.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/07/17/Docker-workshop-5-Docker网络/"/>





  <title>Docker Workshop（五）Docker网络 | 若见喻笺</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">若见喻笺</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/17/Docker-workshop-5-Docker网络/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhang Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="若见喻笺">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Docker Workshop（五）Docker网络</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-17T16:50:23+02:00">
                2017-07-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Devops/" itemprop="url" rel="index">
                    <span itemprop="name">Devops</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>　　<a href="http://zhangyuyu.github.io/2017/07/13/Docker-workshop-4-Docker%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/" target="_blank" rel="noopener">上一篇 Docker的数据存储</a>主要讲述Docker数据管理的两种方式：数据卷和数据卷容器。<br>本篇主要讲述网络的实现、网络模型、网络模式等相关知识。</p>
<h2 id="二、背景"><a href="#二、背景" class="headerlink" title="二、背景"></a>二、背景</h2><p>　　该系列《Docker in Prodcution》内容包含如下部分：</p>
<ul>
<li><a href="http://zhangyuyu.github.io/2017/07/09/Docker-workshop-1-%E5%AE%B9%E5%99%A8%E7%AE%80%E4%BB%8B/" target="_blank" rel="noopener">容器简介</a></li>
<li><a href="http://zhangyuyu.github.io/2017/07/10/Docker-workshop-2-Docker%E7%AE%80%E4%BB%8B/" target="_blank" rel="noopener">Docker简介</a></li>
<li><a href="http://zhangyuyu.github.io/2017/07/11/Docker-workshop-3-Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" target="_blank" rel="noopener">Docker的基本操作</a></li>
<li><a href="http://zhangyuyu.github.io/2017/07/13/Docker-workshop-4-Docker%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/" target="_blank" rel="noopener">Docker数据存储</a></li>
<li><strong>Docker网络</strong></li>
<li><a href="http://zhangyuyu.github.io/2017/07/20/Docker-workshop-6-Docker%E5%AE%89%E5%85%A8/" target="_blank" rel="noopener">Docker安全</a></li>
<li>多主机部署</li>
<li>服务发现</li>
<li>日志、跟踪、监控</li>
</ul>
<h2 id="三、网络的实现"><a href="#三、网络的实现" class="headerlink" title="三、网络的实现"></a>三、网络的实现</h2><p>　　Docker现有的网络模型主要是通过使用Network namespace、Linux Bridge、Iptables、veth pair等技术实现的。<br><a id="more"></a></p>
<ul>
<li>Network namespace（网络命名空间）<br>　　Network namespace主要提供了关于网络资源的隔离，包括网络设备、IPv4和IPv6协议栈、IP路由表、防火墙、/proc/net目录、/sys/class/net目录、端口（socket）等。</li>
<li>Linux Bridge<br>　　功能相当于物理交换机，为连在其上的设备（容器）转发数据帧。如docker0网桥。</li>
<li>Iptables<br>　　主要为容器提供NAT以及容器网络安全。</li>
<li>veth pair（虚拟网络设备）<br>　　两个虚拟网卡组成的数据通道。在Docker中，用于连接Docker容器和Linux Bridge。一端在容器中作为eth0网卡，另一端在Linux Bridge中作为网桥的一个端口。</li>
</ul>
<h2 id="四、网络创建过程"><a href="#四、网络创建过程" class="headerlink" title="四、网络创建过程"></a>四、网络创建过程</h2><img src="/imgs/docker-network-implement.png" width="500" height="250">
<p>　　Docker创建一个容器的时候，会具体执行如下操作：</p>
<ul>
<li>创建一对虚拟接口，即veth pair，分别放到宿主机和容器中;</li>
<li>本地主机一端的虚拟接口，连接到默认的docker0网桥或指定网桥上，并具有一个以veth开头的唯一的名字，如veth0ac844e;</li>
<li>容器一端的虚拟接口，将放到新容器中，并修改名字为eth0，该接口只在容器的命名空间可见;</li>
<li>从网桥可用地址段中获取一个空闲地址分配给容器的eth0（例如172.17.0.2/16），并配置默认路由网关为dokcer0的IP地址。</li>
</ul>
<p>　　完成这些配置之后，该容器就可以使用eth0虚拟网卡来连接其它容器和访问外部网络了。<br>　　当该容器结束后，Docker会清空容器，容器内的网络接口eth0会随网络命名空间一起被清除，veth0ac844e接口也被自动从docker0卸载。</p>
<p>　　另外，可以在docker运行的时候通过–net参数指定容器的网络配置，有<a href="#1-单节点网络模式">四个可选值</a>。</p>
<h3 id="【练习1】网络创建细节"><a href="#【练习1】网络创建细节" class="headerlink" title="【练习1】网络创建细节"></a>【练习1】网络创建细节</h3><p>1）启动一个 /bin/bash 容器，指定 –net=none 参数</p>
<pre><code>$ sudo docker run -i -t --rm --net=none busybox /bin/sh
</code></pre><p>2) 在<code>本地主机</code>查找容器的进程 id，并为它创建网络命名空间。</p>
<pre><code>$ sudo docker inspect -f &apos;{{.State.Pid}}&apos; 5259b04d2a50
2559
$ pid=2559
$ sudo mkdir -p /var/run/netns
$ sudo ln -s /proc/$pid/ns/net /var/run/netns/$pid
</code></pre><p>3）查看网桥docker0分配的子网段</p>
<pre><code>$ ip addr show docker0
6: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default
    link/ether 02:42:89:d3:35:32 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.1/16 scope global docker0
       valid_lft forever preferred_lft forever
    inet6 fe80::42:89ff:fed3:3532/64 scope link
       valid_lft forever preferred_lft forever
</code></pre><p>4) 创建一对 “veth pair” 接口 A 和 B，绑定 A 到网桥 docker0，并启用它</p>
<pre><code>$ sudo ip link add A type veth peer name B
$ sudo brctl addif docker0 A
$ sudo ip link set A up
</code></pre><p>5）将B放到容器的网络命名空间，命名为 eth0，启动它并配置一个可用 IP（桥接网段）和默认网关</p>
<pre><code>$ sudo ip link set B netns $pid
$ sudo ip netns exec $pid ip link set dev B name eth0
$ sudo ip netns exec $pid ip link set eth0 up
$ sudo ip netns exec $pid ip addr add 172.17.42.1/16 dev eth0
$ sudo ip netns exec $pid ip route add default via 172.17.0.1
</code></pre><p>6) 其他指令</p>
<pre><code># 查看网桥docker0上的虚拟接口
$ brctl show
bridge name bridge id       STP enabled interfaces
br-fe42067d4b8f     8000.0242987a3884   no
docker0     8000.024289d33532   no      veth76e4a32
lxcbr0      8000.000000000000   no

# 查看网桥docker0的生成树状态
$ brctl show docker0
bridge name bridge id       STP enabled interfaces
docker0     8000.024289d33532   no      veth76e4a32

# 查看网桥docker0的网卡驱动类型
$ ethtool -i docker0
driver: bridge
version: 2.3
firmware-version: N/A
bus-info: N/A
supports-statistics: no
supports-test: no
supports-eeprom-access: no
supports-register-dump: no
supports-priv-flags: no

# 查看该网络接口的唯一识别编号peer_ifindex
$ ethtool -S veth76e4a32
NIC statistics:
     peer_ifindex: 7

# 查看路由信息
$ sudo iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:domain
ACCEPT     udp  --  anywhere             anywhere             udp dpt:domain
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:bootps
ACCEPT     udp  --  anywhere             anywhere             udp dpt:bootps
Chain FORWARD (policy ACCEPT)
target     prot opt source               destination
DROP       all  --  172.18.0.0/16        172.17.0.0/16
DROP       all  --  172.17.0.0/16        172.18.0.0/16
DOCKER     all  --  anywhere             anywhere
ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED
ACCEPT     all  --  anywhere             anywhere
ACCEPT     all  --  anywhere             anywhere
DOCKER     all  --  anywhere             anywhere
ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED
ACCEPT     all  --  anywhere             anywhere
ACCEPT     all  --  anywhere             anywhere
ACCEPT     all  --  anywhere             anywhere
ACCEPT     all  --  anywhere             anywhere
Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
Chain DOCKER (2 references)
target     prot opt source               destination
ACCEPT     tcp  --  anywhere             172.17.0.2           tcp dpt:5000
</code></pre><h2 id="五、网络模型"><a href="#五、网络模型" class="headerlink" title="五、网络模型"></a>五、网络模型</h2><h3 id="基本组件"><a href="#基本组件" class="headerlink" title="基本组件"></a>基本组件</h3><p>　　在容器网络模型中，通常会包括容器(Container)、沙箱(Sandbox)、端点(Endpoint)、网络(Network)等组件，其中，网络会涉及桥接网(Bridge Network)或重叠网(Overlay Network)。<br><img src="/imgs/docker-network-concept.png" width="500" height="250"></p>
<ul>
<li>容器(Container): 容器能够作为任意一个或多个网络的一部分，能够同时对接桥接网和重叠网网络。</li>
<li>沙箱(Sandbox): 包含容器网络堆栈配置信息，是一个隔离的环境，可能包含多网络的多个端点。</li>
<li>端点(Endpoint): 连接沙箱和网络的接口，绑定到特定的网络，比如之前提到的veth pair。</li>
<li>网络(Network): 使得一组端点之间能够相互直接交流的，实现可以是Linux网桥或重叠</li>
</ul>
<h3 id="与Docker-Links对比"><a href="#与Docker-Links对比" class="headerlink" title="与Docker Links对比"></a>与Docker Links对比</h3><p>与Docker Links进行简单对比，Docker Links允许容器之间互相发现，并使用容器名作为别名进行互相之间的通信，比DNS或服务发现更容易使用，且不用关心端口映射，但Docker Links有一些限制，比如:</p>
<ul>
<li>只能在同一宿主机内使用，不能跨主机</li>
<li>重新创建容器会移除之前的链接(Links)</li>
<li>被链接的容器必须是一个已经启动的容器<br>因此，在Docker 1.9版本之后，官方推荐使用Docker网络功能代替Docker Links。Docker容器网络模型的主要优势在于:</li>
<li>在某个特定网络下的所有容器能自由地相互通信</li>
<li>多个网络有助于分散容器之间的流量传输</li>
<li>多个端点允许一个容器加入到多个网络中</li>
<li>能够支持同主机和跨主机的容器间通信</li>
</ul>
<h2 id="四、Docker网络模式"><a href="#四、Docker网络模式" class="headerlink" title="四、Docker网络模式"></a>四、Docker网络模式</h2><p><a href="#1-单节点网络模式">1. 单节点网络模式</a></p>
<ul>
<li><a href="#1-1.bridge模式">bridge模式</a></li>
<li><a href="#1-2.host模式">host模式</a></li>
<li><a href="#1-3.container模式">container模式</a> </li>
<li><a href="#1-4.none模式">none模式</a></li>
</ul>
<p><a href="#2-多节点网络模式">2. 多节点网络模式</a></p>
<ul>
<li><a href="#2-1.原生支持">原生支持</a></li>
<li><a href="#2-2.插件">插件</a></li>
</ul>
<h3 id="1-单节点网络模式"><a href="#1-单节点网络模式" class="headerlink" title="1-单节点网络模式"></a>1-单节点网络模式</h3><h4 id="1-1-bridge模式"><a href="#1-1-bridge模式" class="headerlink" title="1-1.bridge模式"></a>1-1.bridge模式</h4><p>使用–net=bridge指定<br>该模式中，Docker守护进程创建一个虚拟以太网桥docker0，附加在其上的任何网卡之间都能自动转发数据包。默认情况下，守护进程会创建一对对等接口，将其中一个接口设置为容器的eth0接口，另一个接口放置在宿主机的命名空间中，从而将宿主机上的所有容器都连接到这个内部网络上。同时，守护进程还会从网桥的私有地址空间中分配一个IP地址和子网给该容器。</p>
<h4 id="1-2-host模式"><a href="#1-2-host模式" class="headerlink" title="1-2.host模式"></a>1-2.host模式</h4><p>使用–net=host指定<br>该模式将禁用Docker容器的网络隔离。因为容器共享了宿主机的网络命名空间，直接暴露在公共网络中。因此，你需要通过端口映射（port mapping）来进行协调。</p>
<p>当使用host模式网络时，容器实际上继承了宿主机的IP地址。该模式比bridge模式更快（因为没有路由开销），但是它将容器直接暴露在公共网络中，是有安全隐患的。</p>
<h4 id="1-3-container模式"><a href="#1-3-container模式" class="headerlink" title="1-3.container模式"></a>1-3.container模式</h4><p>使用–net=container指定<br>该模式会重用另一个容器的网络命名空间。通常来说，当你想要自定义网络栈时，该模式是很有用的。实际上，该模式也是Kubernetes使用的网络模式。</p>
<h4 id="1-4-none模式"><a href="#1-4-none模式" class="headerlink" title="1-4.none模式"></a>1-4.none模式</h4><p>使用–net=none指定<br>该模式将容器放置在它自己的网络栈中，但是并不进行任何配置。实际上，该模式关闭了容器的网络功能，在以下两种情况下是有用的：容器并不需要网络（例如只需要写磁盘卷的批处理任务）；你希望自定义网络。</p>
<p>####【练习2】单主机创建网络<br>1) 创建<code>web</code>网络，并创建一个基于<code>web</code>网络的容器<code>web_container</code></p>
<pre><code>$ docker network create web
a3f32cf362412ca10cc375c0cbf304c15b1cfd2a0da6addb97ef3606bcb04350
$ docker network ls
NETWORK ID          NAME                DRIVER
134b9d559a29        host                host
20d10cc6ad42        bridge              bridge
a3f32cf36241        web                 bridge
e7f9d75e45b8        none                null
$ docker run -itd --net=web --name web_container busybox
fdec55f5db5da821825fe5b091e69e248f8f346273a9397ea66a931b4c26bb7f
$ docker network inspect web
[
    {
        &quot;Name&quot;: &quot;web&quot;,
        &quot;Id&quot;: &quot;a3f32cf362412ca10cc375c0cbf304c15b1cfd2a0da6addb97ef3606bcb04350&quot;,
        &quot;Scope&quot;: &quot;local&quot;,
        &quot;Driver&quot;: &quot;bridge&quot;,
        &quot;IPAM&quot;: {
            &quot;Driver&quot;: &quot;default&quot;,
            &quot;Config&quot;: [
                {}
            ]
        },
        &quot;Containers&quot;: {
            &quot;fdec55f5db5da821825fe5b091e69e248f8f346273a9397ea66a931b4c26bb7f&quot;: {
                &quot;EndpointID&quot;: &quot;67b284bcef2544ec153c90e041c7d51351d5f2cea63e31537352e37ac8fb1fe6&quot;,
                &quot;MacAddress&quot;: &quot;02:42:ac:12:00:02&quot;,
                &quot;IPv4Address&quot;: &quot;172.18.0.2/16&quot;,
                &quot;IPv6Address&quot;: &quot;&quot;
            }
        },
        &quot;Options&quot;: {}
    }
]
</code></pre><p>2） 重复操作<code>1）</code>，创建另外一个基于<code>app</code>网络的容器</p>
<pre><code>$ docker network create app
$ docker network ls
NETWORK ID          NAME                DRIVER
20d10cc6ad42        bridge              bridge
a3f32cf36241        web                 bridge
e7f9d75e45b8        none                null
134b9d559a29        host                host
73eda6fce093        app                 bridge
$ docker run -itd --name app_container --net=app busybox
$ docker network inspect app
</code></pre><p>3) 连接<code>web_container</code>到<code>app</code>网络</p>
<pre><code>$ docker network connect app web_container
</code></pre><p>这样<code>web_container</code>就可以通过<code>web_container.app</code>连接<code>app</code>网络了:</p>
<pre><code>$ docker exec app_container ping web_container.app
PING web_container.app (172.19.0.3): 56 data bytes
64 bytes from 172.19.0.3: seq=0 ttl=64 time=0.118 ms
64 bytes from 172.19.0.3: seq=1 ttl=64 time=0.080 ms
</code></pre><p>4) 连接<code>app_container</code>到<code>web</code>网络</p>
<pre><code># 连接之前：
$ docker exec web_container ping app_container.web
ping: bad address &apos;app_container.web&apos;

# 连接
$ docker network connect web app_container

# 连接之后
$ docker exec web_container ping app_container.web
PING app_container.web (172.18.0.3): 56 data bytes
64 bytes from 172.18.0.3: seq=0 ttl=64 time=0.219 ms
64 bytes from 172.18.0.3: seq=1 ttl=64 time=0.111 ms
</code></pre><p>5) 查看网络信息</p>
<ul>
<li><p>查看连接之后web网络的containers里面就有两个container了</p>
<p>  $ docker network inspect web<br>  [</p>
<pre><code>{
    &quot;Name&quot;: &quot;web&quot;,
    &quot;Id&quot;: &quot;a3f32cf362412ca10cc375c0cbf304c15b1cfd2a0da6addb97ef3606bcb04350&quot;,
    &quot;Scope&quot;: &quot;local&quot;,
    &quot;Driver&quot;: &quot;bridge&quot;,
    &quot;IPAM&quot;: {
        &quot;Driver&quot;: &quot;default&quot;,
        &quot;Config&quot;: [
            {}
        ]
    },
    &quot;Containers&quot;: {
        &quot;59b01ca0444b4c708b521725532762512bc57ec9fdfccb2e2a6addef8a072f05&quot;: {
            &quot;EndpointID&quot;: &quot;dd969e4ec9703cf87adfd97b22bb8e06ec8a12139c948aceb6aea70388d23d31&quot;,
            &quot;MacAddress&quot;: &quot;02:42:ac:12:00:03&quot;,
            &quot;IPv4Address&quot;: &quot;172.18.0.3/16&quot;,
            &quot;IPv6Address&quot;: &quot;&quot;
        },
        &quot;fdec55f5db5da821825fe5b091e69e248f8f346273a9397ea66a931b4c26bb7f&quot;: {
            &quot;EndpointID&quot;: &quot;67b284bcef2544ec153c90e041c7d51351d5f2cea63e31537352e37ac8fb1fe6&quot;,
            &quot;MacAddress&quot;: &quot;02:42:ac:12:00:02&quot;,
            &quot;IPv4Address&quot;: &quot;172.18.0.2/16&quot;,
            &quot;IPv6Address&quot;: &quot;&quot;
        }
    },
    &quot;Options&quot;: {}
}
</code></pre><p>  ]                                   </p>
</li>
<li><p>查看container的NetworkSettings，里面Networks有两个网络了：</p>
<p>  $ docker inspect web_container<br>  “Networks”: {</p>
<pre><code>    &quot;app&quot;: {
        &quot;EndpointID&quot;: &quot;b06bbe5ea7dbaa96fecb2165404185effa0d6ebf01b028633f2afe00664cf16d&quot;,
        &quot;Gateway&quot;: &quot;172.19.0.1&quot;,
        &quot;IPAddress&quot;: &quot;172.19.0.3&quot;,
        &quot;IPPrefixLen&quot;: 16,
        &quot;IPv6Gateway&quot;: &quot;&quot;,
        &quot;GlobalIPv6Address&quot;: &quot;&quot;,
        &quot;GlobalIPv6PrefixLen&quot;: 0,
        &quot;MacAddress&quot;: &quot;02:42:ac:13:00:03&quot;
    },
    &quot;web&quot;: {
        &quot;EndpointID&quot;: &quot;67b284bcef2544ec153c90e041c7d51351d5f2cea63e31537352e37ac8fb1fe6&quot;,
        &quot;Gateway&quot;: &quot;172.18.0.1&quot;,
        &quot;IPAddress&quot;: &quot;172.18.0.2&quot;,
        &quot;IPPrefixLen&quot;: 16,
        &quot;IPv6Gateway&quot;: &quot;&quot;,
        &quot;GlobalIPv6Address&quot;: &quot;&quot;,
        &quot;GlobalIPv6PrefixLen&quot;: 0,
        &quot;MacAddress&quot;: &quot;02:42:ac:12:00:02&quot;
    }
}
</code></pre></li>
</ul>
<h3 id="2-多节点网络模式"><a href="#2-多节点网络模式" class="headerlink" title="2-多节点网络模式"></a>2-多节点网络模式</h3><h4 id="2-1-原生支持"><a href="#2-1-原生支持" class="headerlink" title="2-1.原生支持"></a>2-1.原生支持</h4><p>Docker 在 1.19 版本中引入的基于 VxLAN 的对跨节点网络的原生支持，即自带重叠网络(Overlay Network) 组件。<br>Docker 支持 Consul, Etcd, 和 ZooKeeper 三种分布式key-value 存储。其中，etcd 是一个高可用的分布式 k/v存储系统，使用etcd的场景默认处理的数据都是控制数据，对于应用数据，只推荐数据量很小，但是更新访问频繁的情况。</p>
<h4 id="【练习3】利用Docker-Swarm多主机创建网络"><a href="#【练习3】利用Docker-Swarm多主机创建网络" class="headerlink" title="【练习3】利用Docker Swarm多主机创建网络"></a>【练习3】利用Docker Swarm多主机创建网络</h4><p>1) 先准备两台虚拟机作为Docker Swarm的两个节点Node1，Node2。</p>
<pre><code>$ midir docker-cluster
$ cd docker-cluster
$ vim Vagrantfile
</code></pre><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="number">2</span>) <span class="built_in">do</span> |<span class="type">config</span>|<span class="type"></span></span><br><span class="line"><span class="type">  (1</span>.<span class="number">.2</span>).each <span class="built_in">do</span> |<span class="type">i</span>|<span class="type"></span></span><br><span class="line"><span class="type">    config</span>.vm.define <span class="string">"wanzi-node#&#123;i&#125;"</span> <span class="built_in">do</span> |<span class="type">node</span>|<span class="type"></span></span><br><span class="line"><span class="type">      node</span>.vm.box = <span class="string">"comiq/dockerbox"</span></span><br><span class="line">      node.vm.provider <span class="string">"virtualbox"</span> <span class="built_in">do</span> |<span class="type">vb</span>|<span class="type"></span></span><br><span class="line"><span class="type">        vb</span>.name = <span class="string">"wanzi-node#&#123;i&#125;"</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>$ vagrant up
Bringing machine &apos;wanzi-node1&apos; up with &apos;virtualbox&apos; provider...
Bringing machine &apos;wanzi-node2&apos; up with &apos;virtualbox&apos; provider...
==&gt; wanzi-node1: Checking if box &apos;comiq/dockerbox&apos; is up to date...
==&gt; wanzi-node1: VirtualBox VM is already running.
==&gt; wanzi-node2: Importing base box &apos;comiq/dockerbox&apos;...
==&gt; wanzi-node2: Matching MAC address for NAT networking...
==&gt; wanzi-node2: Checking if box &apos;comiq/dockerbox&apos; is up to date...
==&gt; wanzi-node2: Setting the name of the VM: wanzi-node2
==&gt; wanzi-node2: Fixed port collision for 22 =&gt; 2222. Now on port 2201.
==&gt; wanzi-node2: Clearing any previously set network interfaces...
==&gt; wanzi-node2: Preparing network interfaces based on configuration...
    wanzi-node2: Adapter 1: nat
==&gt; wanzi-node2: Forwarding ports...
    wanzi-node2: 22 =&gt; 2201 (adapter 1)
==&gt; wanzi-node2: Booting VM...
==&gt; wanzi-node2: Waiting for machine to boot. This may take a few minutes...
    wanzi-node2: SSH address: 127.0.0.1:2201
    wanzi-node2: SSH username: vagrant
    wanzi-node2: SSH auth method: private key
    wanzi-node2: Warning: Connection timeout. Retrying...
==&gt; wanzi-node2: Machine booted and ready!
==&gt; wanzi-node2: Checking for guest additions in VM...
==&gt; wanzi-node2: Mounting shared folders...
    wanzi-node2: /vagrant =&gt; /Users/yuzhang/Downloads/Devops/docker_cluster
</code></pre><p>2） <strong>Node1</strong>作为Manager<br>登陆到Node1:</p>
<pre><code>$ vagrant ssh wanzi-node1
Welcome to Ubuntu 16.04 LTS (GNU/Linux 4.4.0-21-generic x86_64)
 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
</code></pre><p>在Node1上初始化并创建Docker Swarm，作为Manager:</p>
<pre><code>vagrant@vagrant:~$  docker swarm init --advertise-addr 192.168.59.1:2377
Swarm initialized: current node (85qhfwludbf603gcazjqippl2) is now a manager.
To add a worker to this swarm, run the following command:
docker swarm join \
--token SWMTKN-1-5rv6l22kow7fhpthihiy5oqi8ka4mospeele38ycsfuwsviv1y-bekemef3aafmbanavzkeekjch \
192.168.59.1:2377
</code></pre><p>To add a manager to this swarm, run ‘docker swarm join-token manager’ and follow the instructions.</p>
<p>3) <strong>Node2</strong>作为Worker<br>登陆到Node2:</p>
<pre><code>$ vagrant ssh wanzi-node1
</code></pre><p>在Node2上运行如下命令加入到Swarm中，作为Worker:</p>
<pre><code>vagrant@vagrant:~$ docker swarm join \
&gt;     --token SWMTKN-1-5rv6l22kow7fhpthihiy5oqi8ka4mospeele38ycsfuwsviv1y-bekemef3aafmbanavzkeekjch \
&gt;     192.168.59.1:2377
This node joined a swarm as a worker.
</code></pre><p>4) 在<strong>Node1</strong>上查看所有node信息</p>
<pre><code>vagrant@vagrant:~$ docker node ls
ID                           HOSTNAME  STATUS  AVAILABILITY  MANAGER STATUS
85qhfwludbf603gcazjqippl2 *  vagrant   Ready   Active        Leader
9o4sy1vcd5nygr77jrjpl28sn    vagrant   Ready   Active
</code></pre><p>5) 在<strong>Node2</strong>上则<strong>不</strong>能查看所有node信息</p>
<pre><code>vagrant@vagrant:~$ docker node ls
Error response from daemon: This node is not a swarm manager. Worker nodes can&apos;t be used to view or modify cluster state. Please run this command on a manager node or promote the current node to a manager.
</code></pre><p>6) 在<strong>Node1</strong>上创建<code>overlay</code>网络</p>
<pre><code>vagrant@vagrant:~$ docker network create -d=overlay net_overlay
0aa8c2nu8vwwbep0spui8upva
vagrant@vagrant:~$ docker network ls
NETWORK ID          NAME                DRIVER              SCOPE
9cbbdda300b9        bridge              bridge              local
eb0832fa48cc        docker_gwbridge     bridge              local
d9cbc7492332        host                host                local
6agtuhiw3e1r        ingress             overlay             swarm
0aa8c2nu8vww        net_overlay         overlay             swarm
e5bb8590c3b8        none                null                local
</code></pre><p>这样，所有在Swarm中的主机都可以访问该网络了，除了docker0默认网桥外，这里多出了一个docker_gwbridge的网桥，docker0在跨多主机容器网络中并没有被用到，而是docker_gwbridge替代了docker0用来实现Overlay网络中容器间的通信以及容器到外部的通信，其职能就和单机容器网络中docker0一样。</p>
<pre><code>vagrant@vagrant:~$ docker network inspect net_overlay
[
    {
        &quot;Name&quot;: &quot;net_overlay&quot;,
        &quot;Id&quot;: &quot;0aa8c2nu8vwwbep0spui8upva&quot;,
        &quot;Scope&quot;: &quot;swarm&quot;,
        &quot;Driver&quot;: &quot;overlay&quot;,
        &quot;EnableIPv6&quot;: false,
        &quot;IPAM&quot;: {
            &quot;Driver&quot;: &quot;default&quot;,
            &quot;Options&quot;: null,
            &quot;Config&quot;: []
        },
        &quot;Internal&quot;: false,
        &quot;Containers&quot;: null,
        &quot;Options&quot;: {
            &quot;com.docker.network.driver.overlay.vxlanid_list&quot;: &quot;257&quot;
        },
        &quot;Labels&quot;: null
    }
]
</code></pre><p>7) 创建服务<br>　　创建一个名为hello的服务，包含2个副本，使用sleep infinity的命令运行，该命令使得容器不会立即退出:</p>
<pre><code>vagrant@vagrant:~$ docker service ls
ID            NAME   REPLICAS  IMAGE   COMMAND
alq1vrojrwd6  hello  0/2       ubuntu  sleep infinity
vagrant@vagrant:~$ docker service ps hello
ID                         NAME     IMAGE   NODE     DESIRED STATE  CURRENT STATE          ERROR
66zkihz10oaoxv1i94niud0cy  hello.1  ubuntu  vagrant  Running        Running 4 seconds ago
08stnpfqhg3rhtb1nd3dxxade  hello.2  ubuntu  vagrant  Running        Running 5 seconds ago
</code></pre><p>可以分别在Node1和Node2上查看运行的容器：<br>Node1:</p>
<pre><code>vagrant@vagrant:~$ docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
63f768d6b911        ubuntu:latest       &quot;sleep infinity&quot;    28 seconds ago      Up 27 seconds                           hello.2.08stnpfqhg3rhtb1nd3dxxade
</code></pre><p>Node2:</p>
<pre><code>vagrant@vagrant:~$ docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
e506461b95f3        ubuntu:latest       &quot;sleep infinity&quot;    48 seconds ago      Up 47 seconds                           hello.1.66zkihz10oaoxv1i94niud0cy
</code></pre><p>8) 检查连通性<br>Node1:</p>
<pre><code>vagrant@vagrant:~$ docker inspect -f {{.NetworkSettings.Networks.net_overlay.IPAddress}}  63f768d6b911
10.0.0.4
</code></pre><p>Node2:</p>
<pre><code>vagrant@vagrant:~$ docker inspect -f {{.NetworkSettings.Networks.net_overlay.IPAddress}}  e506461b95f3
10.0.0.3

 vagrant@vagrant:~$ docker exec hello.1.66zkihz10oaoxv1i94niud0cy apt-get update; apt-get install iputils-ping -y; ping 10.0.0.4
</code></pre><h4 id="2-2-插件"><a href="#2-2-插件" class="headerlink" title="2-2.插件"></a>2-2.插件</h4><p>该方式是通过插件（plugin）方式引入的第三方实现方案，比如 Weave, Calico, Contiv Netplugin, Cisco, VMware, MidoNet, pipework, flannel等等。</p>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>本篇文章主要是讲述Docker网络相关的内容，包括Docker的网络实现、网络创建过程、网络模型组件与优势、网络模式（单节点、多节点）等。<br><a href="http://zhangyuyu.github.io/2017/07/20/Docker-workshop-6-Docker%E5%AE%89%E5%85%A8/" target="_blank" rel="noopener">下一篇</a>将讲述Docker的安全。</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a href="http://dockone.io/article/1261" target="_blank" rel="noopener">Docker网络模式</a></li>
<li><a href="http://www.cnblogs.com/sammyliu/p/5894191.html" target="_blank" rel="noopener">理解Docker网络</a></li>
<li><a href="https://yeasy.gitbooks.io/docker_practice/content/advanced_network/&lt;ptp class=&quot;html&quot;&gt;&lt;/ptp" target="_blank" rel="noopener">Docker从入门到实践-高级网络配置</a></li>
<li><a href="http://dockone.io/article/1736" target="_blank" rel="noopener">使用Docker Swarm来运行服务</a></li>
<li><a href="http://kiwenlau.com/2016/07/03/vagrant-vm-cluster/" target="_blank" rel="noopener">使用Vagrant创建多节点虚拟机集群</a></li>
</ul>

      
    </div>
    
    
    

    
      <div>
        <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/imgs/qr-code.png" alt="Zhang Yu wechat" style="width: 200px; max-width: 100%;"/>
    <div>扫一扫，用手机访问本站</div>
</div>

      </div>
    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Docker/" rel="tag"># Docker</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/07/13/Docker-workshop-4-Docker数据存储/" rel="next" title="Docker Workshop（四）Docker数据存储">
                <i class="fa fa-chevron-left"></i> Docker Workshop（四）Docker数据存储
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/07/20/Docker-workshop-6-Docker安全/" rel="prev" title="Docker Workshop（六）Docker安全">
                Docker Workshop（六）Docker安全 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Zhang Yu</p>
              <p class="site-description motion-element" itemprop="description">行是知之始，知是行之成</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">59</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">26</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、前言"><span class="nav-number">1.</span> <span class="nav-text">一、前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、背景"><span class="nav-number">2.</span> <span class="nav-text">二、背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、网络的实现"><span class="nav-number">3.</span> <span class="nav-text">三、网络的实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、网络创建过程"><span class="nav-number">4.</span> <span class="nav-text">四、网络创建过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#【练习1】网络创建细节"><span class="nav-number">4.1.</span> <span class="nav-text">【练习1】网络创建细节</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、网络模型"><span class="nav-number">5.</span> <span class="nav-text">五、网络模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本组件"><span class="nav-number">5.1.</span> <span class="nav-text">基本组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#与Docker-Links对比"><span class="nav-number">5.2.</span> <span class="nav-text">与Docker Links对比</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、Docker网络模式"><span class="nav-number">6.</span> <span class="nav-text">四、Docker网络模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-单节点网络模式"><span class="nav-number">6.1.</span> <span class="nav-text">1-单节点网络模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-bridge模式"><span class="nav-number">6.1.1.</span> <span class="nav-text">1-1.bridge模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-host模式"><span class="nav-number">6.1.2.</span> <span class="nav-text">1-2.host模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-container模式"><span class="nav-number">6.1.3.</span> <span class="nav-text">1-3.container模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-none模式"><span class="nav-number">6.1.4.</span> <span class="nav-text">1-4.none模式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-多节点网络模式"><span class="nav-number">6.2.</span> <span class="nav-text">2-多节点网络模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-原生支持"><span class="nav-number">6.2.1.</span> <span class="nav-text">2-1.原生支持</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#【练习3】利用Docker-Swarm多主机创建网络"><span class="nav-number">6.2.2.</span> <span class="nav-text">【练习3】利用Docker Swarm多主机创建网络</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-插件"><span class="nav-number">6.2.3.</span> <span class="nav-text">2-2.插件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最后"><span class="nav-number">7.</span> <span class="nav-text">最后</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">8.</span> <span class="nav-text">References</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhang Yu</span>
  
   <span style="margin-left:8px;">
   <script src="http://s6.cnzz.com/stat.php?id=1263347220&web_id=1263347220" type="text/javascript"></script>
   </span>


  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1263347220&web_id=1263347220" language="JavaScript"></script>
  </div>



        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>


  

  <div style="display: none;">
    <script src="https://s19.cnzz.com/z_stat.php?id=1263347220&web_id=1263347220" language="JavaScript"></script>
  </div>




  


  




	





  





  












  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  


</body>
</html>
